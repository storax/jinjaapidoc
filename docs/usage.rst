========
Usage
========

To use Jinja Api Documentation in a project, add it to the extensions in your sphinx ``conf.py``::

  extensions = [
    'jinjaapidoc',
  ]

.. important:: jinjaapidoc will generate files. Other extensions, such as autosummary might want
               to process them, so add these extensions afterwards.
               The autosummary extension will automatically be enabled by jinjaapidoc.


Configuration
-------------

There are a few config values you can set. The only necessary one is the srcdir:


  :jinjaapi_srcdir: **REQUIRED!** the path to the source directory of your python code.
  :jinjaapi_outputdir: directory for generated files. Defaults to the documenation source directory (ssually the directory of conf.py).
  :jinjaapi_nodelete: :class:`bool` - If False, delete the output directory first. Defaults to False
  :jinjaapi_exclude_paths: :class:`list` - A list of paths to exclude.
  :jinjaapi_force: :class:`bool` - If True, overwrite existing files. Defaults to True
  :jinjaapi_followlinks: :class:`bool` - If True, follow symbolic links.
  :jinjaapi_dryrun: :class:`bool` - If True, do not create any files. Defaults to False.
  :jinjaapi_includeprivate: :class:`bool` - If True, include private modules.
  :jinjaapi_templatedirs: :class:`list` - list of directorys to search for templates.
                          The templates used for rendering should be named ``module.rst`` and
			  ``package.rst``. If no modules are found, use the default templates
			  provided by this package.

Documenter
----------

The jinjaapidoc package provides an additional :class:`sphinx.ext.autodoc.ModuleDocumenter`: :class:`jinjaapidoc.ext.ModDocstringDocumenter`.
The documenter will only insert the docstring of the module but will not create any
index. Use him like this (replace ``<<package.module>>``)::

  .. automoddoconly:: <<package.module>>

Templates
---------

You can use your own templates for rendering the rst files.
Add the directory with the templates to ``jinjaapi_templatedirs`` in the ``conf.py``.
You can provide a ``module.rst`` and ``package.rst`` template.

The context for the templates is generated by :func:`jinjaapidoc.gendoc.get_context`.
Variables you can use are:

  * :package: The top package
  * :module: the module
  * :fullname: package.module
  * :subpkgs: packages beneath module
  * :submods: modules beneath module
  * :classes: public classes in module
  * :allclasses: public and private classes in module
  * :exceptions: public exceptions in module
  * :allexceptions: public and private exceptions in module
  * :functions: public functions in module
  * :allfunctions: public and private functions in module
  * :data: public data in module
  * :alldata: public and private data in module
  * :members: dir(module)

The default template looks like this::

  {% block header %}
  :mod:`{{ fullname }}`
  ======={% for c in fullname %}={% endfor %}
  {% endblock %}
  
  {% block subpackages %}{% if subpkgs %}
  Subpackages
  -----------
  .. toctree::
     :maxdepth: 3
  
  {% for p in subpkgs %}   {{ fullname }}.{{ p }}
  {% endfor %}
  {% endif %}{% endblock %}
  {% block submodules %}{% if submods %}
  Submodules
  ----------
  .. toctree::
     :maxdepth: 1
  
  {% for m in submods %}   {{ fullname }}.{{ m }}
  {% endfor %}
  {% endif %}{% endblock %}
  {% block contents %}{% if ispkg %}Module contents
  ---------------{% endif %}
  
  .. automoddoconly:: {{ fullname }}
  
  .. currentmodule:: {{ fullname }}
  
  {% block classsummary %}{% if classes %}
  Classes
  ~~~~~~~
  
  .. autosummary::
     :toctree: {{ fullname }}
  
  {% for c in classes %}     {{ c }}
  {% endfor %}
  {% endif %}{% endblock %}
  
  
  {% block exceptionssummary %}{% if exceptions %}
  Exceptions
  ~~~~~~~~~~
  
  .. autosummary::
     :toctree: {{ fullname }}
  
  {% for e in exceptions %}     {{ e }}
  {% endfor %}
  {% endif %}{% endblock %}
  {% block functionsssummary %}{% if functions %}
  Functions
  ~~~~~~~~~
  
  .. autosummary::
  
  {% for f in functions %}     {{ f }}
  {% endfor %}
  {% endif %}{% endblock %}
  {% block datasummary%}{% if data %}
  Data
  ~~~~
  
  .. autosummary::
  
  {% for d in data %}     {{ d }}
  {% endfor %}
  {% endif %}{% endblock %}
  
  {% block functionsdoc %}{% for f in functions %}.. autofunction:: {{ f }}
  {% endfor %}{% endblock %}
  {% block datadoc %}{% for d in data %}.. autodata:: {{ d}}
  {% endfor %}{% endblock %}
  {% endblock %}

